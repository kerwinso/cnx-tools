<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>CNX URL to JSON loader</title>
<style>
.link {
  color: blue;
  text-decoration: underline;
}

.link:hover {
  cursor: pointer;
  text-decoration: none;
}

</style>

<script type="text/javascript">
// URL to shorten == https://dev00.cnx.org/contents/GFy_h8cu@10.61:rZudN6XP@2/Introduction
// URL to return == https://archive-dev00.cnx.org/contents/GFy_h8cu@10.61.json

function book_json() {
  var book_url = prompt('Enter full CNX URL for the book/collection:');

  const regex = /^[a-z]+:\/\/([\S]+):/;
  var book_match = regex.exec(book_url);
  short_url_book = book_match[1];

//check if prod
  if (short_url_book.includes('.cnx')) {
    var book_json_url = "https://archive-" + short_url_book + ".json" ;
  }
  else {
    var book_json_url = "https://archive." + short_url_book + ".json" ;
  }
  window.open(book_json_url, "_top", "false");
}

function page_json() {
  var book_url = prompt('Enter full CNX URL for the book/collection:');
  const regex = /^[a-z]+:\/\/([\S]+):/;
  var page_match = regex.exec(book_url);
  short_url_page = page_match[1];
  var page_json_url = "https://archive-" + short_url_book + ".json" ;
  window.open(page_json_url, "_top", "false");

}


</script>
</head>

<body>
  <span onclick="book_json()" class="link">Load book/collection json </span>
  <br> <br>
  <span onclick="" class="link">Load page/module json</span>
</body>
</html>
