<!DOCTYPE html>
<head>
  <title>CNX Latest Repo Tags</title>
  <meta charset="UTF-8">
  <meta name=viewport content="width=512">
  <script>

    function getLatestTag(repo) {
      //repo = 'cnx-deploy'
      tags_url = 'https://api.github.com/repos/Connexions/' + repo + '/tags';
      var xhr = new XMLHttpRequest();
      xhr.onreadystatechange = function() {
        if (xhr.readyState == XMLHttpRequest.DONE) {
          response = xhr.responseText;
          resp = JSON.parse(response);
          text = repo + ' latest tag: ' + resp[0].name;
          node = document.createElement("p");
          textnode = document.createTextNode(text);
          node.appendChild(textnode);
          document.getElementById("content").appendChild(node);
          }
        }
      xhr.open('GET', tags_url, true);
      xhr.send(null);
    }

    // for user input
    function lookupLatestTag(repo) {
      repo = document.getElementById("repo-input").value;
      //alert(repo);
      tags_url = 'https://api.github.com/repos/Connexions/' + repo + '/tags';
      var xhr = new XMLHttpRequest();
      xhr.onreadystatechange = function() {
        if (xhr.readyState == XMLHttpRequest.DONE) {
          response = xhr.responseText;
          resp = JSON.parse(response);
          text = repo + ' latest tag: ' + resp[0].name;
          alert(text);
          }
        }
      xhr.open('GET', tags_url, true);
      xhr.send(null);

    }

  </script>
</head>
<body>

  <h1>CNX Latest Repo Tags</h1>

  <h4>Lists the latest tags from public Github CNX repos only (unauthenticated... so far).
  </h4>

  <!-- <p onclick="getLatestTag('cnx-deploy')">Click here
  </p>

  <p onclick="getLatestTag('cnx-press')">Then here
  </p> -->

<p>Enter Connexions repo name to get the latest tag number:
  <br><br>
  <input id="repo-input">
  <button type="button" onclick="lookupLatestTag()">Submit</button>
</p>

<br/>
<hr>
  <script>getLatestTag('cnx-deploy');</script>
  <script>getLatestTag('webview');</script>
  <script>getLatestTag('cnx-recipes');</script>
  <script>getLatestTag('cnx-press');</script>
  <script>getLatestTag('nebuchadnezzar');</script>
  <script>getLatestTag('rhaptos.cnxmlutils');</script>
  <script>getLatestTag('cnxml');</script>
  <script>getLatestTag('cnx-archive');</script>
  <script>getLatestTag('cnx-db');</script>
  <script>getLatestTag('cnx-publishing');</script>
  <script>getLatestTag('cnx-easybake');</script>
  <script>getLatestTag('cnx-epub');</script>
  <!-- <script>getLatestTag('baked-pdf');</script> -->


  <p id="content">
  </p>

</body>
</html>
