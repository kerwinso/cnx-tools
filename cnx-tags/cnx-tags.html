<!DOCTYPE html>
<head>
  <title>CNX Latest Repo Tags</title>
  <meta charset="UTF-8">
  <meta name=viewport content="width=512">
  <script>

//   add links?
//   <script type="text/javascript">
// newlink = document.createElement('a');
// newlink.innerHTML = 'Google';
// newlink.setAttribute('title', 'Google');
// newlink.setAttribute('href', 'http://google.com');
// document.body.appendChild(newlink);
//

    function getLatestTag(repo) {
      tags_url = 'https://api.github.com/repos/Connexions/' + repo + '/tags';
      var xhr = new XMLHttpRequest();
      xhr.onreadystatechange = function() {
        if (xhr.readyState == XMLHttpRequest.DONE) {
          response = xhr.responseText;
          resp = JSON.parse(response);
          text = 'Latest tag for Connexions/' + repo + ': ' + resp[0].name;
          node = document.createElement("p");
          textnode = document.createTextNode(text);
          node.appendChild(textnode);
          document.getElementById("content").appendChild(node);
          }
        }
      xhr.open('GET', tags_url, true);
      xhr.send(null);
    }

    function getLatestRhaptosTag(repo) {
      tags_url = 'https://api.github.com/repos/Rhaptos/' + repo + '/tags';
      var xhr = new XMLHttpRequest();
      xhr.onreadystatechange = function() {
        if (xhr.readyState == XMLHttpRequest.DONE) {
          response = xhr.responseText;
          resp = JSON.parse(response);
          text = 'Latest tag for Rhaptos/' + repo + ': ' + resp[0].name;
          node = document.createElement("p");
          textnode = document.createTextNode(text);
          node.appendChild(textnode);
          document.getElementById("content").appendChild(node);
          }
        }
      xhr.open('GET', tags_url, true);
      xhr.send(null);
    }

    // for user input
    function lookupLatestTag(repo) {
      repo = document.getElementById("repo-input").value;
      //alert(repo);
      tags_url = 'https://api.github.com/repos/Connexions/' + repo + '/tags';
      var xhr = new XMLHttpRequest();
      xhr.onreadystatechange = function() {
        if (xhr.readyState == XMLHttpRequest.DONE) {
          response = xhr.responseText;
          resp = JSON.parse(response);
          text = 'Latest tag for ' + repo + ': ' + resp[0].name;
          alert(text);
          }
        }
      xhr.open('GET', tags_url, true);
      xhr.send(null);
    }

  </script>
</head>
<body>

  <h1>CNX Latest Repo Tags</h1>

  <h4>Lists the latest tags from public Github CNX repos only (unauthenticated... so far).
  </h4>

  <!-- <p onclick="getLatestTag('cnx-deploy')">Click here
  </p>

  <p onclick="getLatestTag('cnx-press')">Then here
  </p> -->

<p>Enter Connexions repo name to get the latest tag number:
  <br><br>
  <input id="repo-input">
  <button type="submit" onclick="lookupLatestTag()">Submit</button>
</p>
<p>If it didn't work, either the repo isn't public, the repo isn't part of Connexions, you spelled something wrong, or we hit the API limit. Which you would know if nearly everything below the line below is blank.</p>

<hr>
<p><a href="https://github.com/Connexions/oer.exports/releases">oer.exports releases </a> (private)</p>

  <!-- <script>getLatestTag('cnx-archive');</script>
  <script>getLatestTag('cnx-db');</script>
  <script>getLatestTag('cnx-deploy');</script>
  <script>getLatestTag('cnx-easybake');</script>
  <script>getLatestTag('cnx-epub');</script>
  <script>getLatestTag('cnx-press');</script>
  <script>getLatestTag('cnx-publishing');</script>
  <script>getLatestTag('cnx-recipes');</script>
  <script>getLatestTag('cnxml');</script>
  <script>getLatestTag('nebuchadnezzar');</script>
  <script>getLatestTag('rhaptos.cnxmlutils');</script>
  <script>getLatestTag('webview');</script>
   -->
  <!-- <script>getLatestTag('baked-pdf');</script> -->

  <!-- <script>getLatestRhaptosTag('Products.CNXMLDocument');</script>
  <script>getLatestRhaptosTag('Products.RhaptosCollection');</script>
  <script>getLatestRhaptosTag('Products.RhaptosModuleEditor');</script>
  <script>getLatestRhaptosTag('Products.RhaptosModuleStorage');</script>
  <script>getLatestRhaptosTag('Products.RhaptosRepository');</script>
-->




  <p id="content">
  </p>

</body>
</html>
